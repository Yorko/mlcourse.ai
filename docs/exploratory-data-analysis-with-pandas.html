<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Exploratory Data Analysis with Pandas</title>
        <link rel="stylesheet" href="http://festline.github.io/theme/css/main.css" />
        <link href="http://festline.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="mlcourse.ai Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://festline.github.io/">mlcourse.ai </a></h1>
                <nav><ul>
                    <li class="active"><a href="http://festline.github.io/category/posts.html">posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://festline.github.io/exploratory-data-analysis-with-pandas.html" rel="bookmark"
           title="Permalink to Exploratory Data Analysis with Pandas">Exploratory Data Analysis with Pandas</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-02-28T20:00:00+03:00">
                Published: ср 28 февраля 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://festline.github.io/author/yury-kashnitsky.html">Yury Kashnitsky</a>
        </address>
<p>In <a href="http://festline.github.io/category/posts.html">posts</a>.</p>
<p>tags: <a href="http://festline.github.io/tag/python-pandas.html">python pandas</a> </p>
</footer><!-- /.post-info -->      <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><center>
<img src="../../img/ods_stickers.jpg" /></center></p>
<h2 id="Open-Machine-Learning-Course">Open Machine Learning Course<a class="anchor-link" href="#Open-Machine-Learning-Course">¶</a></h2><p><center>Authors: <a href="https://www.linkedin.com/in/festline/">Yury Kashnitsky</a>, data scientist @ Mail.Ru Group, Ekaterina Demidova, data scientist @ Segmento <br>
Translated and edited by <a href="https://www.linkedin.com/in/yuanyuanpao/">Yuanyuan Pao</a>, Christina Butsko, Anastasia Manokhina, Sergey Isaev and Artem Trunov <br>All content is distributed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons CC BY-NC-SA 4.0</a> license.</br></br></center></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1><center> Topic 1. Exploratory data analysis with Pandas</center></h1>
<p><img align="center" src="https://habrastorage.org/files/10c/15f/f3d/10c15ff3dcb14abdbabdac53fed6d825.jpg" />
<br /></p>
<h3 id="Plan-of-this-article">Plan of this article<a class="anchor-link" href="#Plan-of-this-article">¶</a></h3><ol>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#1.-About-the-course">About the course</a></li>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#2.-Assignments">Assignments</a></li>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#3.-Demonstration-of-main-Pandas-methods">Demonstration of main Pandas methods</a></li>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#4.-First-attempt-on-predicting-telecom-churn">First attempt on predicting telecom churn</a></li>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#5.-Assignment-#1">Assignment #1</a></li>
<li><a href="http://localhost:8888/notebooks/jupyter_english/topic01/%5BENG%5D_topic1_habr_pandas.ipynb#6.-Useful-resources">Useful resources</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-About-the-course">1. About the course<a class="anchor-link" href="#1.-About-the-course">¶</a></h2><p>With this article, we, <a href="https://www.linkedin.com/company/11241268/">OpenDataScience</a>, launch an open Machine Learning course. This is not aimed at developing another <em>comprehensive</em> introductory course on machine learning or data analysis (so this is not a substitute for fundamental education or online/offline courses/specializations and books). The purpose of this series of articles is to quickly refresh your knowledge and help you find topics for further advancement. Our approach is similar to that of the authors of <a href="http://www.deeplearningbook.org/">Deep Learning book</a>, which starts off with a review of mathematics and basics of machine learning – short, concise, and with many references to other resources.</p>
<p>The course is designed to perfectly balance theory and practice; therefore, each topic is followed by an <strong>assignment</strong> with a deadline in a week. You can also take part in several Kaggle Inclass <strong>competitions</strong> held during the course.</p>
<h3 id="Syllabus">Syllabus<a class="anchor-link" href="#Syllabus">¶</a></h3><ol>
<li>Exploratory data analysis with Pandas</li>
<li>Visual data analysis with Python</li>
<li>Classification, Decision Trees, and k Nearest Neighbors</li>
<li>Linear Classification and Regression</li>
<li>Bagging and Random Forest</li>
<li>Feature engineering and feature selection</li>
<li>Unsupervised Learning: Principal Component Anslysis and Clustering</li>
<li>Vowpal Wabbit: Learning with gigabytes of data</li>
<li>Time series analysis with Python</li>
<li>Gradient Boosting</li>
</ol>
<h3 id="Community">Community<a class="anchor-link" href="#Community">¶</a></h3><p>One of the most vivid advantages of our course is active community. If you join the OpenDataScience Slack team, you’ll find the authors of articles and assignments right there in the same channel (#eng_mlcourse_open) eager to help you. This can help very much when you make your first steps in any discipline. Fill in <a href="https://docs.google.com/forms/d/1lejiyldtlHxwwDpWiEqFmaUFUOVfkm9BMjoZurR895c/edit">this form</a> to be invited. The form will ask you several questions about your background and skills, including a few easy math questions.</p>
<p>We chat informally, like humor and emoji. Not every MOOC can boast to have such an alive community. There is also a <a href="https://www.reddit.com/r/ods_ai/">subreddit</a> designed for students participating in the course.</p>
<h3 id="Prereqiusites">Prereqiusites<a class="anchor-link" href="#Prereqiusites">¶</a></h3><p>The prerequisites are the following: basic concepts from calculus, linear algebra, probability theory and statistics, and Python programming skills. If you need to catch up, a good resource will be <a href="http://www.deeplearningbook.org/contents/part_basics.html">Part I</a> from the "Deep Learning" book and various math and Python online courses (for Python, CodeAcademy will do). More info is available on the corresponding <a href="https://github.com/Yorko/mlcourse_open/wiki/Prerequisites:-Python,-math-and-DevOps">Wiki page</a>.</p>
<h3 id="What-software-you’ll-need">What software you’ll need<a class="anchor-link" href="#What-software-you’ll-need">¶</a></h3><p>As for now, you’ll only need <a href="https://www.continuum.io/downloads">Anaconda</a> (built with Python 3.6) to reproduce the code in the course. Later in the course, you’ll have to install other libraries like Xgboost and Vowpal Wabbit.</p>
<p>You can also resort to the <a href="https://hub.docker.com/r/festline/mlcourse_open/">Docker container</a> with all necessary software already installed. More info is available on the corresponding <a href="https://github.com/Yorko/mlcourse_open/wiki/Software-requirements-and-Docker-container">Wiki page</a>.</p>
<h2 id="2.-Assignments">2. Assignments<a class="anchor-link" href="#2.-Assignments">¶</a></h2><ul>
<li>Each article comes with an assignment in the form of a <a href="http://jupyter.org">Jupyter</a> notebook. The task will be to fill in the missing code snippets and to answer questions in a Google Quiz form;</li>
<li>Each assignment is due in a week with a hard deadline;</li>
<li>Please discuss the course content (articles and assignments) in the #eng_mlcourse_open cahnnel of the OpenDataScience Slack team or here in the comments to articles on Medium;</li>
<li>The solutions to assignments will be sent to those who have submitted the corresponding Google form.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Demonstration-of-main-Pandas-methods">3. Demonstration of main Pandas methods<a class="anchor-link" href="#3.-Demonstration-of-main-Pandas-methods">¶</a></h2><p>Well.. There are dozens of cool tutorials on Pandas and visual data analysis. If you are familiar with these topics, just wait for the 3rd article in the series, where we get into machine learning.</p>
<p><strong><a href="http://pandas.pydata.org">Pandas</a></strong> is a Python library that provides extensive means for data analysis. Data scientists often work with data stored in table formats like <code>.csv</code>, <code>.tsv</code>, or <code>.xlsx</code>. Pandas makes it very convenient to load, process, and analyze such tabular data using SQL-like queries. In conjunction with <code>Matplotlib</code> and <code>Seaborn</code>, <code>Pandas</code> provides a wide range of opportunities for visual analysis of tabular data.</p>
<p>The main data structures in <code>Pandas</code> are implemented with <strong>Series</strong> and <strong>DataFrame</strong> classes. The former is a one-dimensional indexed array of some fixed data type. The latter is a two-dimensional data structure - a table - where each column contains data of the same type. You can see it as a dictionary of <code>Series</code> instances. <code>DataFrames</code> are great for representing real data: rows correspond to instances (objects, observations, etc.), and columns correspond to features for each of the instances.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We’ll demonstrate the main methods in action by analyzing a <a href="https://bigml.com/user/francisco/gallery/dataset/5163ad540c0b5e5b22000383">dataset</a> on the churn rate of telecom operator clients. Let’s read the data (using <code>read_csv</code>), and take a look at the first 5 lines using the <code>head</code> method:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'../../data/telecom_churn.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>99</td>
<td>16.78</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>False</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>26</td>
<td>161.6</td>
<td>123</td>
<td>27.47</td>
<td>195.5</td>
<td>103</td>
<td>16.62</td>
<td>254.4</td>
<td>103</td>
<td>11.45</td>
<td>13.7</td>
<td>3</td>
<td>3.70</td>
<td>1</td>
<td>False</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>243.4</td>
<td>114</td>
<td>41.38</td>
<td>121.2</td>
<td>110</td>
<td>10.30</td>
<td>162.6</td>
<td>104</td>
<td>7.32</td>
<td>12.2</td>
<td>5</td>
<td>3.29</td>
<td>0</td>
<td>False</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>Yes</td>
<td>No</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>88</td>
<td>5.26</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>False</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>Yes</td>
<td>No</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>122</td>
<td>12.61</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>False</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<details>
<summary>About printing DataFrames in Jupyter notebooks</summary>
<p>
In Jupyter notebooks, Pandas DataFrames are printed as these pretty tables seen above while `print(df.head())` looks worse.
By default, Pandas displays 20 columns and 60 rows, so, if your DataFrame is bigger, use the `set_option` function as shown in the example below:

```python
pd.set_option('display.max_columns', 100)
pd.set_option('display.max_rows', 100)
```
</p>
</details><p>Recall that each row corresponds to one client, the <strong>object</strong> of our research, and columns are <strong>features</strong> of the object.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let’s have a look at data dimensionality, features names, and feature types.</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(3333, 20)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the output, we can see that the table contains 3333 rows and 20 columns.</p>
<p>Now let’s try printing out the column names using <code>columns</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Index(['State', 'Account length', 'Area code', 'International plan',
       'Voice mail plan', 'Number vmail messages', 'Total day minutes',
       'Total day calls', 'Total day charge', 'Total eve minutes',
       'Total eve calls', 'Total eve charge', 'Total night minutes',
       'Total night calls', 'Total night charge', 'Total intl minutes',
       'Total intl calls', 'Total intl charge', 'Customer service calls',
       'Churn'],
      dtype='object')
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the <code>info()</code> method to output some general information about the dataframe:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><class &#x27;pandas.core.frame.dataframe&#x27;>
RangeIndex: 3333 entries, 0 to 3332
Data columns (total 20 columns):
State                     3333 non-null object
Account length            3333 non-null int64
Area code                 3333 non-null int64
International plan        3333 non-null object
Voice mail plan           3333 non-null object
Number vmail messages     3333 non-null int64
Total day minutes         3333 non-null float64
Total day calls           3333 non-null int64
Total day charge          3333 non-null float64
Total eve minutes         3333 non-null float64
Total eve calls           3333 non-null int64
Total eve charge          3333 non-null float64
Total night minutes       3333 non-null float64
Total night calls         3333 non-null int64
Total night charge        3333 non-null float64
Total intl minutes        3333 non-null float64
Total intl calls          3333 non-null int64
Total intl charge         3333 non-null float64
Customer service calls    3333 non-null int64
Churn                     3333 non-null bool
dtypes: bool(1), float64(8), int64(8), object(3)
memory usage: 498.1+ KB
None
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>bool</code>, <code>int64</code>, <code>float64</code> and <code>object</code> are the data types of our features. We see that one feature is logical (<code>bool</code>), 3 features are of type <code>object</code>, and 16 features are numeric. With this same method, we can easily see if there are any missing values. Here, there are none because each column contains 3333 observations, the same number of rows we saw before with <code>shape</code>.</p>
<p>We can <strong>change the column type</strong> with the <code>astype</code> method. Let’s apply this method to the <code>Churn</code> feature to convert it into <code>int64</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'int64'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>describe</code> method shows basic statistical characteristics of each numerical feature (<code>int64</code> and <code>float64</code> types): number of non-missing values, mean, standard deviation, range, median, 0.25 and 0.75 quartiles.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Account length</th>
<th>Area code</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
<td>3333.000000</td>
</tr>
<tr>
<th>mean</th>
<td>101.064806</td>
<td>437.182418</td>
<td>8.099010</td>
<td>179.775098</td>
<td>100.435644</td>
<td>30.562307</td>
<td>200.980348</td>
<td>100.114311</td>
<td>17.083540</td>
<td>200.872037</td>
<td>100.107711</td>
<td>9.039325</td>
<td>10.237294</td>
<td>4.479448</td>
<td>2.764581</td>
<td>1.562856</td>
<td>0.144914</td>
</tr>
<tr>
<th>std</th>
<td>39.822106</td>
<td>42.371290</td>
<td>13.688365</td>
<td>54.467389</td>
<td>20.069084</td>
<td>9.259435</td>
<td>50.713844</td>
<td>19.922625</td>
<td>4.310668</td>
<td>50.573847</td>
<td>19.568609</td>
<td>2.275873</td>
<td>2.791840</td>
<td>2.461214</td>
<td>0.753773</td>
<td>1.315491</td>
<td>0.352067</td>
</tr>
<tr>
<th>min</th>
<td>1.000000</td>
<td>408.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>23.200000</td>
<td>33.000000</td>
<td>1.040000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>25%</th>
<td>74.000000</td>
<td>408.000000</td>
<td>0.000000</td>
<td>143.700000</td>
<td>87.000000</td>
<td>24.430000</td>
<td>166.600000</td>
<td>87.000000</td>
<td>14.160000</td>
<td>167.000000</td>
<td>87.000000</td>
<td>7.520000</td>
<td>8.500000</td>
<td>3.000000</td>
<td>2.300000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>50%</th>
<td>101.000000</td>
<td>415.000000</td>
<td>0.000000</td>
<td>179.400000</td>
<td>101.000000</td>
<td>30.500000</td>
<td>201.400000</td>
<td>100.000000</td>
<td>17.120000</td>
<td>201.200000</td>
<td>100.000000</td>
<td>9.050000</td>
<td>10.300000</td>
<td>4.000000</td>
<td>2.780000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>75%</th>
<td>127.000000</td>
<td>510.000000</td>
<td>20.000000</td>
<td>216.400000</td>
<td>114.000000</td>
<td>36.790000</td>
<td>235.300000</td>
<td>114.000000</td>
<td>20.000000</td>
<td>235.300000</td>
<td>113.000000</td>
<td>10.590000</td>
<td>12.100000</td>
<td>6.000000</td>
<td>3.270000</td>
<td>2.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>max</th>
<td>243.000000</td>
<td>510.000000</td>
<td>51.000000</td>
<td>350.800000</td>
<td>165.000000</td>
<td>59.640000</td>
<td>363.700000</td>
<td>170.000000</td>
<td>30.910000</td>
<td>395.000000</td>
<td>175.000000</td>
<td>17.770000</td>
<td>20.000000</td>
<td>20.000000</td>
<td>5.400000</td>
<td>9.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to see statistics on non-numerical features, one has to explicitly indicate data types of interest in the <code>include</code> parameter.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">'object'</span><span class="p">,</span> <span class="s1">'bool'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>International plan</th>
<th>Voice mail plan</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>3333</td>
<td>3333</td>
<td>3333</td>
</tr>
<tr>
<th>unique</th>
<td>51</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<th>top</th>
<td>WV</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<th>freq</th>
<td>106</td>
<td>3010</td>
<td>2411</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For categorical (type <code>object</code>) and boolean (type <code>bool</code>) features we can use the <code>value_counts</code> method. Let’s have a look at the distribution of <code>Churn</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0    2850
1     483
Name: Churn, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2850 users out of 3333 are loyal; their <code>Churn</code> value is <code>0</code>. To calculate the proportion, pass <code>normalize=True</code> to the <code>value_counts</code> function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0    0.855086
1    0.144914
Name: Churn, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sorting">Sorting<a class="anchor-link" href="#Sorting">¶</a></h3><p>A DataFrame can be sorted by the value of one of the variables (i.e columns). For example, we can sort by Total day charge (use <code>ascending=False</code> to sort in descending order):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'Total day charge'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>365</th>
<td>CO</td>
<td>154</td>
<td>415</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>350.8</td>
<td>75</td>
<td>59.64</td>
<td>216.5</td>
<td>94</td>
<td>18.40</td>
<td>253.9</td>
<td>100</td>
<td>11.43</td>
<td>10.1</td>
<td>9</td>
<td>2.73</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>985</th>
<td>NY</td>
<td>64</td>
<td>415</td>
<td>Yes</td>
<td>No</td>
<td>0</td>
<td>346.8</td>
<td>55</td>
<td>58.96</td>
<td>249.5</td>
<td>79</td>
<td>21.21</td>
<td>275.4</td>
<td>102</td>
<td>12.39</td>
<td>13.3</td>
<td>9</td>
<td>3.59</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2594</th>
<td>OH</td>
<td>115</td>
<td>510</td>
<td>Yes</td>
<td>No</td>
<td>0</td>
<td>345.3</td>
<td>81</td>
<td>58.70</td>
<td>203.4</td>
<td>106</td>
<td>17.29</td>
<td>217.5</td>
<td>107</td>
<td>9.79</td>
<td>11.8</td>
<td>8</td>
<td>3.19</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>156</th>
<td>OH</td>
<td>83</td>
<td>415</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>337.4</td>
<td>120</td>
<td>57.36</td>
<td>227.4</td>
<td>116</td>
<td>19.33</td>
<td>153.9</td>
<td>114</td>
<td>6.93</td>
<td>15.8</td>
<td>7</td>
<td>4.27</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>605</th>
<td>MO</td>
<td>112</td>
<td>415</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>335.5</td>
<td>77</td>
<td>57.04</td>
<td>212.5</td>
<td>109</td>
<td>18.06</td>
<td>265.0</td>
<td>132</td>
<td>11.93</td>
<td>12.7</td>
<td>8</td>
<td>3.43</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Alternatively, we can also sort by multiple columns:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">,</span> <span class="s1">'Total day charge'</span><span class="p">],</span>
        <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>688</th>
<td>MN</td>
<td>13</td>
<td>510</td>
<td>No</td>
<td>Yes</td>
<td>21</td>
<td>315.6</td>
<td>105</td>
<td>53.65</td>
<td>208.9</td>
<td>71</td>
<td>17.76</td>
<td>260.1</td>
<td>123</td>
<td>11.70</td>
<td>12.1</td>
<td>3</td>
<td>3.27</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<th>2259</th>
<td>NC</td>
<td>210</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>31</td>
<td>313.8</td>
<td>87</td>
<td>53.35</td>
<td>147.7</td>
<td>103</td>
<td>12.55</td>
<td>192.7</td>
<td>97</td>
<td>8.67</td>
<td>10.1</td>
<td>7</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<th>534</th>
<td>LA</td>
<td>67</td>
<td>510</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>310.4</td>
<td>97</td>
<td>52.77</td>
<td>66.5</td>
<td>123</td>
<td>5.65</td>
<td>246.5</td>
<td>99</td>
<td>11.09</td>
<td>9.2</td>
<td>10</td>
<td>2.48</td>
<td>4</td>
<td>0</td>
</tr>
<tr>
<th>575</th>
<td>SD</td>
<td>114</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>36</td>
<td>309.9</td>
<td>90</td>
<td>52.68</td>
<td>200.3</td>
<td>89</td>
<td>17.03</td>
<td>183.5</td>
<td>105</td>
<td>8.26</td>
<td>14.2</td>
<td>2</td>
<td>3.83</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>2858</th>
<td>AL</td>
<td>141</td>
<td>510</td>
<td>No</td>
<td>Yes</td>
<td>28</td>
<td>308.0</td>
<td>123</td>
<td>52.36</td>
<td>247.8</td>
<td>128</td>
<td>21.06</td>
<td>152.9</td>
<td>103</td>
<td>6.88</td>
<td>7.4</td>
<td>3</td>
<td>2.00</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Indexing-and-retrieving-data">Indexing and retrieving data<a class="anchor-link" href="#Indexing-and-retrieving-data">¶</a></h3><p>DataFrame can be indexed in different ways.</p>
<p>To get a single column, you can use a <code>DataFrame['Name']</code> construction. Let's use this to answer a question about that column alone: <strong>what is the proportion of churned users in our dataframe?</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[13]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.14491449144914492</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>14.5% is actually quite bad for a company; such a churn rate can make the company go bankrupt.</p>
<p><strong>Boolean indexing</strong> with one column is also very convenient. The syntax is <code>df[P(df['Name'])]</code>, where <code>P</code> is some logical condition that is checked for each element of the <code>Name</code> column. The result of such indexing is the DataFrame consisting only of rows that satisfy the <code>P</code> condition on the <code>Name</code> column.</p>
<p>Let’s use it to answer the question:</p>
<p><strong>What are average values of numerical variables for churned users?</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Account length            102.664596
Area code                 437.817805
Number vmail messages       5.115942
Total day minutes         206.914079
Total day calls           101.335404
Total day charge           35.175921
Total eve minutes         212.410145
Total eve calls           100.561077
Total eve charge           18.054969
Total night minutes       205.231677
Total night calls         100.399586
Total night charge          9.235528
Total intl minutes         10.700000
Total intl calls            4.163561
Total intl charge           2.889545
Customer service calls      2.229814
Churn                       1.000000
dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>How much time (on average) do churned users spend on phone during daytime?</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'Total day minutes'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>206.91407867494814</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>What is the maximum length of international calls among loyal users (<code>Churn == 0</code>) who do not have an international plan?</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'No'</span><span class="p">)][</span><span class="s1">'Total intl minutes'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>18.899999999999999</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DataFrames can be indexed by column name (label) or row name (index) or by the serial number or a row. The <code>loc</code> method is used for <strong>indexing by name</strong>, while <code>iloc()</code> is used for <strong>indexing by number</strong>.</p>
<p>In the first case, we would say <em>"give us the values of the rows with index from 0 to 5 (inclusive) and columns labeled from State to Area code (inclusive)"</em>, and, in the second case, we would say <em>"give us the values of the first five rows in the first three columns (as in typical Python slice: the maximal value is not included)"</em>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'State'</span><span class="p">:</span><span class="s1">'Area code'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
</tr>
<tr>
<th>5</th>
<td>AL</td>
<td>118</td>
<td>510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we need the first or last line of the data frame, we can use the <code>df[:1]</code> or <code>df[-1:]</code> construct:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>3332</th>
<td>TN</td>
<td>74</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>25</td>
<td>234.4</td>
<td>113</td>
<td>39.85</td>
<td>265.9</td>
<td>82</td>
<td>22.6</td>
<td>241.4</td>
<td>77</td>
<td>10.86</td>
<td>13.7</td>
<td>4</td>
<td>3.7</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Applying-Functions-to-Cells,-Columns-and-Rows">Applying Functions to Cells, Columns and Rows<a class="anchor-link" href="#Applying-Functions-to-Cells,-Columns-and-Rows">¶</a></h3><p><strong>To apply functions to each column, use <code>apply()</code>:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>State                        WY
Account length              243
Area code                   510
International plan          Yes
Voice mail plan             Yes
Number vmail messages        51
Total day minutes         350.8
Total day calls             165
Total day charge          59.64
Total eve minutes         363.7
Total eve calls             170
Total eve charge          30.91
Total night minutes         395
Total night calls           175
Total night charge        17.77
Total intl minutes           20
Total intl calls             20
Total intl charge           5.4
Customer service calls        9
Churn                         1
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>apply</code> method can also be used to apply a function to each line. To do this, specify <code>axis=1</code>. Lambda functions are very convenient in such scenarios. For example, if we need to select all states starting with W, we can do it like this:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">state</span><span class="p">:</span> <span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'W'</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>9</th>
<td>WV</td>
<td>141</td>
<td>415</td>
<td>Yes</td>
<td>Yes</td>
<td>37</td>
<td>258.6</td>
<td>84</td>
<td>43.96</td>
<td>222.0</td>
<td>111</td>
<td>18.87</td>
<td>326.4</td>
<td>97</td>
<td>14.69</td>
<td>11.2</td>
<td>5</td>
<td>3.02</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>26</th>
<td>WY</td>
<td>57</td>
<td>408</td>
<td>No</td>
<td>Yes</td>
<td>39</td>
<td>213.0</td>
<td>115</td>
<td>36.21</td>
<td>191.1</td>
<td>112</td>
<td>16.24</td>
<td>182.7</td>
<td>115</td>
<td>8.22</td>
<td>9.5</td>
<td>3</td>
<td>2.57</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>44</th>
<td>WI</td>
<td>64</td>
<td>510</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>154.0</td>
<td>67</td>
<td>26.18</td>
<td>225.8</td>
<td>118</td>
<td>19.19</td>
<td>265.3</td>
<td>86</td>
<td>11.94</td>
<td>3.5</td>
<td>3</td>
<td>0.95</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>49</th>
<td>WY</td>
<td>97</td>
<td>415</td>
<td>No</td>
<td>Yes</td>
<td>24</td>
<td>133.2</td>
<td>135</td>
<td>22.64</td>
<td>217.2</td>
<td>58</td>
<td>18.46</td>
<td>70.6</td>
<td>79</td>
<td>3.18</td>
<td>11.0</td>
<td>3</td>
<td>2.97</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>54</th>
<td>WY</td>
<td>87</td>
<td>415</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>151.0</td>
<td>83</td>
<td>25.67</td>
<td>219.7</td>
<td>116</td>
<td>18.67</td>
<td>203.9</td>
<td>127</td>
<td>9.18</td>
<td>9.7</td>
<td>3</td>
<td>2.62</td>
<td>5</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>map</code> method can be used to <strong>replace values in a column</strong> by passing a dictionary of the form <code>{old_value: new_value}</code> as its argument:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'No'</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">'Yes'</span> <span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>False</td>
<td>Yes</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>99</td>
<td>16.78</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
<td>False</td>
<td>Yes</td>
<td>26</td>
<td>161.6</td>
<td>123</td>
<td>27.47</td>
<td>195.5</td>
<td>103</td>
<td>16.62</td>
<td>254.4</td>
<td>103</td>
<td>11.45</td>
<td>13.7</td>
<td>3</td>
<td>3.70</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
<td>False</td>
<td>No</td>
<td>0</td>
<td>243.4</td>
<td>114</td>
<td>41.38</td>
<td>121.2</td>
<td>110</td>
<td>10.30</td>
<td>162.6</td>
<td>104</td>
<td>7.32</td>
<td>12.2</td>
<td>5</td>
<td>3.29</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>True</td>
<td>No</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>88</td>
<td>5.26</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>True</td>
<td>No</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>122</td>
<td>12.61</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The same thing can be done with the <code>replace</code> method:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">'Voice mail plan'</span><span class="p">:</span> <span class="n">d</span><span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>99</td>
<td>16.78</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>26</td>
<td>161.6</td>
<td>123</td>
<td>27.47</td>
<td>195.5</td>
<td>103</td>
<td>16.62</td>
<td>254.4</td>
<td>103</td>
<td>11.45</td>
<td>13.7</td>
<td>3</td>
<td>3.70</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
<td>False</td>
<td>False</td>
<td>0</td>
<td>243.4</td>
<td>114</td>
<td>41.38</td>
<td>121.2</td>
<td>110</td>
<td>10.30</td>
<td>162.6</td>
<td>104</td>
<td>7.32</td>
<td>12.2</td>
<td>5</td>
<td>3.29</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>88</td>
<td>5.26</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>122</td>
<td>12.61</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping">Grouping<a class="anchor-link" href="#Grouping">¶</a></h3><p>In general, grouping data in Pandas goes as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">grouping_columns</span><span class="p">)[</span><span class="n">columns_to_show</span><span class="p">]</span><span class="o">.</span><span class="n">function</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>First, the <code>groupby</code> method divides the <code>grouping_columns</code> by their values. They become a new index in the resulting dataframe.</li>
<li>Then, columns of interest are selected (<code>columns_to_show</code>). If <code>columns_to_show</code> is not included, all non groupby clauses will be included.</li>
<li>Finally, one or several functions are applied to the obtained groups per selected columns.</li>
</ol>
<p>Here is an example where we group the data according to the values of the <code>Churn</code> variable and display statistics of three columns in each group:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_to_show</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Total day minutes'</span><span class="p">,</span> <span class="s1">'Total eve minutes'</span><span class="p">,</span> 
                   <span class="s1">'Total night minutes'</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Churn'</span><span class="p">])[</span><span class="n">columns_to_show</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[24]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr>
<th></th>
<th colspan="6" halign="left">Total day minutes</th>
<th colspan="6" halign="left">Total eve minutes</th>
<th colspan="6" halign="left">Total night minutes</th>
</tr>
<tr>
<th></th>
<th>count</th>
<th>mean</th>
<th>std</th>
<th>min</th>
<th>50%</th>
<th>max</th>
<th>count</th>
<th>mean</th>
<th>std</th>
<th>min</th>
<th>50%</th>
<th>max</th>
<th>count</th>
<th>mean</th>
<th>std</th>
<th>min</th>
<th>50%</th>
<th>max</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2850.0</td>
<td>175.175754</td>
<td>50.181655</td>
<td>0.0</td>
<td>177.2</td>
<td>315.6</td>
<td>2850.0</td>
<td>199.043298</td>
<td>50.292175</td>
<td>0.0</td>
<td>199.6</td>
<td>361.8</td>
<td>2850.0</td>
<td>200.133193</td>
<td>51.105032</td>
<td>23.2</td>
<td>200.25</td>
<td>395.0</td>
</tr>
<tr>
<th>1</th>
<td>483.0</td>
<td>206.914079</td>
<td>68.997792</td>
<td>0.0</td>
<td>217.6</td>
<td>350.8</td>
<td>483.0</td>
<td>212.410145</td>
<td>51.728910</td>
<td>70.9</td>
<td>211.3</td>
<td>363.7</td>
<td>483.0</td>
<td>205.231677</td>
<td>47.132825</td>
<td>47.4</td>
<td>204.80</td>
<td>354.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let’s do the same thing, but slightly differently by passing a list of functions to <code>agg()</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_to_show</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Total day minutes'</span><span class="p">,</span> <span class="s1">'Total eve minutes'</span><span class="p">,</span> 
                   <span class="s1">'Total night minutes'</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Churn'</span><span class="p">])[</span><span class="n">columns_to_show</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> 
                                            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr>
<th></th>
<th colspan="4" halign="left">Total day minutes</th>
<th colspan="4" halign="left">Total eve minutes</th>
<th colspan="4" halign="left">Total night minutes</th>
</tr>
<tr>
<th></th>
<th>mean</th>
<th>std</th>
<th>amin</th>
<th>amax</th>
<th>mean</th>
<th>std</th>
<th>amin</th>
<th>amax</th>
<th>mean</th>
<th>std</th>
<th>amin</th>
<th>amax</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>175.175754</td>
<td>50.181655</td>
<td>0.0</td>
<td>315.6</td>
<td>199.043298</td>
<td>50.292175</td>
<td>0.0</td>
<td>361.8</td>
<td>200.133193</td>
<td>51.105032</td>
<td>23.2</td>
<td>395.0</td>
</tr>
<tr>
<th>1</th>
<td>206.914079</td>
<td>68.997792</td>
<td>0.0</td>
<td>350.8</td>
<td>212.410145</td>
<td>51.728910</td>
<td>70.9</td>
<td>363.7</td>
<td>205.231677</td>
<td>47.132825</td>
<td>47.4</td>
<td>354.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary-tables">Summary tables<a class="anchor-link" href="#Summary-tables">¶</a></h3><p>Suppose we want to see how the observations in our sample are distributed in the context of two variables - <code>Churn</code> and <code>International plan</code>. To do so, we can build a <strong>contingency table</strong> using the <code>crosstab</code> method:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>International plan</th>
<th>False</th>
<th>True</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2664</td>
<td>186</td>
</tr>
<tr>
<th>1</th>
<td>346</td>
<td>137</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Voice mail plan'</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Voice mail plan</th>
<th>False</th>
<th>True</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.602460</td>
<td>0.252625</td>
</tr>
<tr>
<th>1</th>
<td>0.120912</td>
<td>0.024002</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that most of the users are loyal and do not use additional services (International Plan/Voice mail).</p>
<p>This will resemble <strong>pivot tables</strong> to those familiar with Excel. And, of course, pivot tables are implemented in Pandas: the <code>pivot_table</code> method takes the following parameters:</p>
<ul>
<li><code>values</code> - a list of variables to calculate statistics for,</li>
<li><code>index</code> – a list of variables to group data by,</li>
<li><code>aggfunc</code> — what statistics we need to calculate for groups - e.g sum, mean, maximum, minimum or something else.</li>
</ul>
<p>Let’s take a look at the average number of day, evening, and night calls by area code:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">([</span><span class="s1">'Total day calls'</span><span class="p">,</span> <span class="s1">'Total eve calls'</span><span class="p">,</span> <span class="s1">'Total night calls'</span><span class="p">],</span>
               <span class="p">[</span><span class="s1">'Area code'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">'mean'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Total day calls</th>
<th>Total eve calls</th>
<th>Total night calls</th>
</tr>
<tr>
<th>Area code</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>408</th>
<td>100.496420</td>
<td>99.788783</td>
<td>99.039379</td>
</tr>
<tr>
<th>415</th>
<td>100.576435</td>
<td>100.503927</td>
<td>100.398187</td>
</tr>
<tr>
<th>510</th>
<td>100.097619</td>
<td>99.671429</td>
<td>100.601190</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="DataFrame-transformations">DataFrame transformations<a class="anchor-link" href="#DataFrame-transformations">¶</a></h3><p>Like many other things in Pandas, adding columns to a DataFrame is doable in many ways.</p>
<p>For example, if we want to calculate the total number of calls for all users, let’s create the <code>total_calls</code> Series and paste it into the DataFrame:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_calls</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total day calls'</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total eve calls'</span><span class="p">]</span> <span class="o">+</span> \
    <span class="n">df</span><span class="p">[</span><span class="s1">'Total night calls'</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total intl calls'</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="s1">'Total calls'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">total_calls</span><span class="p">)</span> 
<span class="c1"># loc parameter is the number of columns after which to insert the Series object</span>
<span class="c1"># we set it to len(df.columns) to paste it at the very end of the dataframe</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>...</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
<th>Total calls</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>...</td>
<td>16.78</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>0</td>
<td>303</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>26</td>
<td>161.6</td>
<td>123</td>
<td>27.47</td>
<td>195.5</td>
<td>...</td>
<td>16.62</td>
<td>254.4</td>
<td>103</td>
<td>11.45</td>
<td>13.7</td>
<td>3</td>
<td>3.70</td>
<td>1</td>
<td>0</td>
<td>332</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
<td>False</td>
<td>False</td>
<td>0</td>
<td>243.4</td>
<td>114</td>
<td>41.38</td>
<td>121.2</td>
<td>...</td>
<td>10.30</td>
<td>162.6</td>
<td>104</td>
<td>7.32</td>
<td>12.2</td>
<td>5</td>
<td>3.29</td>
<td>0</td>
<td>0</td>
<td>333</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>...</td>
<td>5.26</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>0</td>
<td>255</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>...</td>
<td>12.61</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
<td>359</td>
</tr>
</tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is possible to add a column more easily without creating an intermediate Series instance:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Total charge'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total day charge'</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total eve charge'</span><span class="p">]</span> <span class="o">+</span> \
    <span class="n">df</span><span class="p">[</span><span class="s1">'Total night charge'</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Total intl charge'</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>...</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
<th>Total calls</th>
<th>Total charge</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>...</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>0</td>
<td>303</td>
<td>75.56</td>
</tr>
<tr>
<th>1</th>
<td>OH</td>
<td>107</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>26</td>
<td>161.6</td>
<td>123</td>
<td>27.47</td>
<td>195.5</td>
<td>...</td>
<td>254.4</td>
<td>103</td>
<td>11.45</td>
<td>13.7</td>
<td>3</td>
<td>3.70</td>
<td>1</td>
<td>0</td>
<td>332</td>
<td>59.24</td>
</tr>
<tr>
<th>2</th>
<td>NJ</td>
<td>137</td>
<td>415</td>
<td>False</td>
<td>False</td>
<td>0</td>
<td>243.4</td>
<td>114</td>
<td>41.38</td>
<td>121.2</td>
<td>...</td>
<td>162.6</td>
<td>104</td>
<td>7.32</td>
<td>12.2</td>
<td>5</td>
<td>3.29</td>
<td>0</td>
<td>0</td>
<td>333</td>
<td>62.29</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>...</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>0</td>
<td>255</td>
<td>66.80</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>...</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
<td>359</td>
<td>52.09</td>
</tr>
</tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To delete columns or rows, use the <code>drop</code> method, passing the required indexes and the <code>axis</code> parameter (<code>1</code> if you delete columns, and nothing or <code>0</code> if you delete rows). The <code>inplace</code> argument tells whether to change the original DataFrame. With <code>inplace=False</code>, the <code>drop</code> method doesn't change the existing DataFrame and returns a new one with dropped rows or columns. With <code>inplace=True</code>, it alters the DataFrame.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get rid of just created columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Total charge'</span><span class="p">,</span> <span class="s1">'Total calls'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="c1"># and here’s how you can delete rows</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[31]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account length</th>
<th>Area code</th>
<th>International plan</th>
<th>Voice mail plan</th>
<th>Number vmail messages</th>
<th>Total day minutes</th>
<th>Total day calls</th>
<th>Total day charge</th>
<th>Total eve minutes</th>
<th>Total eve calls</th>
<th>Total eve charge</th>
<th>Total night minutes</th>
<th>Total night calls</th>
<th>Total night charge</th>
<th>Total intl minutes</th>
<th>Total intl calls</th>
<th>Total intl charge</th>
<th>Customer service calls</th>
<th>Churn</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KS</td>
<td>128</td>
<td>415</td>
<td>False</td>
<td>True</td>
<td>25</td>
<td>265.1</td>
<td>110</td>
<td>45.07</td>
<td>197.4</td>
<td>99</td>
<td>16.78</td>
<td>244.7</td>
<td>91</td>
<td>11.01</td>
<td>10.0</td>
<td>3</td>
<td>2.70</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>OH</td>
<td>84</td>
<td>408</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>299.4</td>
<td>71</td>
<td>50.90</td>
<td>61.9</td>
<td>88</td>
<td>5.26</td>
<td>196.9</td>
<td>89</td>
<td>8.86</td>
<td>6.6</td>
<td>7</td>
<td>1.78</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>OK</td>
<td>75</td>
<td>415</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>166.7</td>
<td>113</td>
<td>28.34</td>
<td>148.3</td>
<td>122</td>
<td>12.61</td>
<td>186.9</td>
<td>121</td>
<td>8.41</td>
<td>10.1</td>
<td>3</td>
<td>2.73</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<th>5</th>
<td>AL</td>
<td>118</td>
<td>510</td>
<td>True</td>
<td>False</td>
<td>0</td>
<td>223.4</td>
<td>98</td>
<td>37.98</td>
<td>220.6</td>
<td>101</td>
<td>18.75</td>
<td>203.9</td>
<td>118</td>
<td>9.18</td>
<td>6.3</td>
<td>6</td>
<td>1.70</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>6</th>
<td>MA</td>
<td>121</td>
<td>510</td>
<td>False</td>
<td>True</td>
<td>24</td>
<td>218.2</td>
<td>88</td>
<td>37.09</td>
<td>348.5</td>
<td>108</td>
<td>29.62</td>
<td>212.6</td>
<td>118</td>
<td>9.57</td>
<td>7.5</td>
<td>7</td>
<td>2.03</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-First-attempt-on-predicting-telecom-churn">4. First attempt on predicting telecom churn<a class="anchor-link" href="#4.-First-attempt-on-predicting-telecom-churn">¶</a></h2><p>Let's see how churn rate is related to the <em>International plan</em> variable. We’ll do this using a <code>crosstab</code> contingency table and also through visual analysis with <code>Seaborn</code> (however, visual analysis will be covered more thoroughly in the next article).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[32]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>International plan</th>
<th>False</th>
<th>True</th>
<th>All</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2664</td>
<td>186</td>
<td>2850</td>
</tr>
<tr>
<th>1</th>
<td>346</td>
<td>137</td>
<td>483</td>
</tr>
<tr>
<th>All</th>
<td>3010</td>
<td>323</td>
<td>3333</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># some imports and "magic" commands to set up plotting </span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># pip install seaborn </span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'International plan'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'Churn'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that, with <em>International Plan</em>, the churn rate is much higher, which is an interesting observation! Perhaps large and poorly controlled expenses with international calls are very conflict-prone and lead to dissatisfaction among the telecom operator's customers.</p>
<p>Next, let’s look at another important feature – <em>Customer service calls</em>. Let’s also make a summary table and a picture.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Customer service calls'</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[35]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Customer service calls</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>All</th>
</tr>
<tr>
<th>Churn</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>605</td>
<td>1059</td>
<td>672</td>
<td>385</td>
<td>90</td>
<td>26</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>2850</td>
</tr>
<tr>
<th>1</th>
<td>92</td>
<td>122</td>
<td>87</td>
<td>44</td>
<td>76</td>
<td>40</td>
<td>14</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>483</td>
</tr>
<tr>
<th>All</th>
<td>697</td>
<td>1181</td>
<td>759</td>
<td>429</td>
<td>166</td>
<td>66</td>
<td>22</td>
<td>9</td>
<td>2</td>
<td>2</td>
<td>3333</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'Customer service calls'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'Churn'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
fkmSGvL/ATs6jwyQsGTbAAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Perhaps, it is not so obvious from the summary table, but the picture clearly states that the churn rate strongly increases starting from 4 calls to the service center.</p>
<p>Let’s now add a binary attribute to our DataFrame – <code>Customer service calls > 3</code>. And once again, let's see how it relates to churn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Many_service_calls'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Customer service calls'</span><span class="p">]</span> <span class="o">></span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'int'</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Many_service_calls'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Churn</th>
<th>0</th>
<th>1</th>
<th>All</th>
</tr>
<tr>
<th>Many_service_calls</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2721</td>
<td>345</td>
<td>3066</td>
</tr>
<tr>
<th>1</th>
<td>129</td>
<td>138</td>
<td>267</td>
</tr>
<tr>
<th>All</th>
<td>2850</td>
<td>483</td>
<td>3333</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'Many_service_calls'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'Churn'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
1JD/DyelDppTX0kjAAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let’s construct another contingency table that relates <em>Churn</em> with both <em>International plan</em> and freshly created <em>Many_service_calls</em>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Many_service_calls'</span><span class="p">]</span> <span class="o">&</span> <span class="n">df</span><span class="p">[</span><span class="s1">'International plan'</span><span class="p">]</span> <span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Churn'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Churn</th>
<th>0</th>
<th>1</th>
</tr>
<tr>
<th>row_0</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>False</th>
<td>2841</td>
<td>464</td>
</tr>
<tr>
<th>True</th>
<td>9</td>
<td>19</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore, predicting that a customer is loyal (<em>Churn</em>=0) in the case when the number of calls to the service center is less than 4 and the <em>International Plan</em> is added (and predicting <em>Churn</em>=1 otherwise), we might expect an accuracy of 85.8% (we are mistaken only 464 + 9 times). This number, 85.8%, that we got with very simple reasoning serves as a good starting point (<em>baseline</em>) for the further machine learning models that we will build.</p>
<p>As we move on in this course, recall that, before the advent of machine learning, the data analysis process looked something like this. Let's recap what we've covered:</p>
<ul>
<li>The share of loyal clients in the sample is 85.5%. The most naive model that always predicts a "loyal customer" on such data will guess right in about 85.5% of all cases. That is, the proportion of correct answers (<em>accuracy</em>) of subsequent models should be no less than this number, and will hopefully be significantly higher;</li>
<li>With the help of a simple forecast that can be expressed by the following formula: "International plan = True & Customer Service calls > 3 => Churn = 1, else Churn = 0", we can expect a guessing rate of 85.8%, which is just above 85.5%. Subsequently, we'll talk about decision trees and figure out how to find such rules <strong>automatically</strong> based only on the input data;</li>
<li>We got these two baselines without applying machine learning, and they’ll serve as the starting point for our subsequent models. If it turns out that with enormous efforts, we increase the share of correct answers by 0.5% per se, then perhaps we are doing something wrong, and it suffices to confine ourselves to a simple model with two conditions;</li>
<li>Before training complex models, it is recommended to manipulate the data a bit, make some plots, and check simple assumptions. Moreover, in business applications of machine learning, they usually start with simple solutions and then experiment with more complex ones.</li>
</ul>
<h2 id="5.-Assignment-#1">5. Assignment #1<a class="anchor-link" href="#5.-Assignment-#1">¶</a></h2><p>In the first assignment, you'll analyze the UCI Adult data set containing demographic information about the US residents. We suggest that you complete the tasks in the <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic01_pandas_data_analysis/assignment1_pandas_uci_adult.ipynb">Jupyter notebook</a>, and then answer 10 questions in the <a href="https://docs.google.com/forms/d/1ws9mchvdVGRyva_y_cPjASED8ATZTOsQFKfimohNaFE">Google form</a>. You can edit your responses even after submitting the form.</p>
<p><strong>Hard deadline</strong>: February 12, 23:59 CET</p>
<h2 id="6.-Useful-resources">6. Useful resources<a class="anchor-link" href="#6.-Useful-resources">¶</a></h2><ul>
<li>First of all, of course, the <a href="http://pandas.pydata.org/pandas-docs/stable/index.html">official documentation of Pandas</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/10min.html">10 minutes to pandas</a></li>
<li><a href="https://github.com/pandas-dev/pandas/blob/master/doc/cheatsheet/Pandas_Cheat_Sheet.pdf">Pandas cheatsheet PDF</a></li>
<li>GitHub repos: <a href="https://github.com/guipsamora/pandas_exercises/">Pandas exercises</a> and <a href="https://github.com/TomAugspurger/effective-pandas">"Effective Pandas"</a></li>
<li><a href="http://www.scipy-lectures.org/index.html">scipy-lectures.org</a> — tutorials on pandas, numpy, matplotlib and scikit-learn</li>
</ul>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://festline.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>